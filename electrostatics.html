<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>ForceManII: Electrostatics</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ForceManII
   &#160;<span id="projectnumber">0.1</span>
   </div>
   <div id="projectbrief">MM for QM People</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Electrostatics </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><dl class="section warning"><dt>Warning</dt><dd>The included electrostatics term in ForceManII works a little different than in most other programs. Read on to find out why.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>At the moment I have only coded up charge-charge interactions according to Coulomb's law. I have left the name of this term more general anticipating the desire to code up more electrostatic terms.</dd></dl>
<p>In classical electrostatics, given a field of <img class="formulaInl" alt="$N$" src="form_29.png"/> point charges, such that the <img class="formulaInl" alt="$j$" src="form_25.png"/>-th one is located at <img class="formulaInl" alt="$\vec{r}_j$" src="form_30.png"/> and has charge <img class="formulaInl" alt="$q_j$" src="form_31.png"/>, the energy to insert an additional point charge of charge <img class="formulaInl" alt="$q_i$" src="form_32.png"/> at a position <img class="formulaInl" alt="$\vec{r}_i$" src="form_33.png"/> is given by: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ E_i=\sum_{j=0}^N \frac{q_iq_j}{|\vec{r}_i-\vec{r}_j|}, \]" src="form_34.png"/>
</p>
<p> which is Coloumb's law for point charges (up to some constants that depend on the unit choice). The quantity: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ V(\vec{r}_{i};q_j)=\sum_{j=0}^N \frac{q_j}{|\vec{r}_i-\vec{r}_j|} \]" src="form_35.png"/>
</p>
<p> is the electrostatic potential at the point <img class="formulaInl" alt="$\vec{r}_i$" src="form_33.png"/>. Coulomb's law gives us the energy to place the <img class="formulaInl" alt="$i$" src="form_10.png"/>-th charge in the current field. If we want the total energy to assemble the field it is given by considering the placement of each charge and is then given by: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ E=\sum_i E_i=\sum_{i&lt;j}\frac{q_iq_j}{|\vec{r}_i-\vec{r}_j|} \]" src="form_36.png"/>
</p>
<p>In ForceManII all models are given a vector of the internal coordinates they depend on (in this case the distance between two points) and the parameters for each of these internal coordinates. However, the form of Coulomb's law gives the parameters (the charges) in terms of each atom, not a given distance. We can get around this by defining a new parameter, <img class="formulaInl" alt="$t_{ij}=q_iq_j$" src="form_108.png"/>, for each distance. Consequentially, charge-charge interactions used as input in ForceManII should be <img class="formulaInl" alt="$t_{ij}$" src="form_109.png"/>. This can be handled in an automated fashion by defining the combining rule of your force field's charge parameters to be their product. Thus our final energy expression is: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ E(\vec{r};\vec{q})=\sum_{i&lt;j}\frac{t_{ij}}{|\vec{r}_i-\vec{r}_j|} \]" src="form_134.png"/>
</p>
<p> the derivative with respect to <img class="formulaInl" alt="$r_{ij}$" src="form_135.png"/> is: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \frac{\partial E}{\partial r_{ij}}=\frac{-t_{ij}}{|\vec{r}_i-\vec{r}_j|^2} \]" src="form_136.png"/>
</p>
<p> and the second derivative is: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \frac{\partial^2 E}{\partial r_{ij}^2}=\frac{2t_{ij}}{|\vec{r}_i-\vec{r}_j|^3} \]" src="form_137.png"/>
</p>
<p> the <img class="formulaInl" alt="$n$" src="form_44.png"/>-th derivative is: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \frac{\partial^n E}{\partial r_{ij}^n}=\frac{(-1)^n n!t_{ij}}{|\vec{r}_i-\vec{r}_j|^{n+1}} \]" src="form_138.png"/>
</p>
 </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
