<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>ForceManII: Tinker Format</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ForceManII
   &#160;<span id="projectnumber">0.1</span>
   </div>
   <div id="projectbrief">MM for QM People</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Tinker Format </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#file_tinker_param">The Tinker Parameter File</a><ul><li class="level2"><a href="#file_tinker_xyz">The Tinker .xyz File</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><p>Tinker has invented two of its own file formats: .prm and .xyz (the tinker .xyz is not quite the same as the more prevelant standard version seen in electronic structure theory). This page explains the two file formats and represents what we expect them to look like.</p>
<h1><a class="anchor" id="file_tinker_param"></a>
The Tinker Parameter File</h1>
<p>Finding the actual criteria for the format of the Tiker parameter file is somewhat difficult. What is listed here is reverse engineered from the parameter files included with Tinker. The file itself is seperated into three parts. The first part is metadata about the force-field such as citations, combining rules, scale factors, etc. The second part lists all recognized atom types and class types. The third part lists the parameters arranged by atom or class type. A line starting with <code>#</code> character is considered a comment line. <code>!!</code> is also considered a comment character, but is typically used at the end of the line (Presently we do pattern matching on the first column. So as long as the first column is one of the recognized keywords described below and your extra information does not alter the column ordering the line will be parsed correcty regardless of the modifications you make).</p>
<p>The ForceManII API provides the function <code>parse_file</code> which given an <code>std::istream</code> instance (the base class of either an input file or an input stringstream) will parse the Tinker formated stream and provide you a ForceField instance. The parser follows the rules listed in this document.</p>
<dl class="section note"><dt>Note</dt><dd>As implemented in ForceManII, the Tinker Format is case-insensitive. Parsing is handled by matching the keyword in the first column and no additional criteria (<em>e.g.</em> number of columns, prescence of a comment character, etc.). Aside from the metadata, which must come first, the ordering of all sections in the input is arbitrary (<em>e.g.</em> the bond parameters can be before or after the angle parameters)</dd>
<dd>
Types and classes start at 1. A value of 0 is treated as a wildcard. <em>e.g.</em> the parameters for a bond 0 1 are to be used for all bonds involving an atom of type/class 1.</dd></dl>
<h3>Force Field Metadata</h3>
<p>This is the important metadata for a force field:</p>
<ul>
<li><code>radiusrule</code> : can be either <code>ARITHMETIC</code> or <code>GEOMETRIC</code>. This is the type of the average used to combine the van Der Waals radii</li>
<li><code>radiussize</code> : is sigma a <code>RADIUS</code> or a <code>DIAMETER</code></li>
<li><code>radiustype</code> : is sigma for the minimum <code>R-MIN</code> or the zero, <code>SIGMA</code>?</li>
<li><code>epsilonrul</code> : same as <code>radiusrule</code> except for the well-depth</li>
<li><code>vdw-14-scale</code> : this is a scale factor that will be applied to the van Der Waals interactions between 1-4 bonded atoms, i.e. ends of a torsion angle. The actual value applied will be 1.0 over this value</li>
<li><code>chg-14-scale</code> : same as <code>vdw-14-scale</code> except for the charges</li>
<li><code>electric</code> : Coulomb's constant ( <img class="formulaInl" alt="$\frac{1}{4\pi\epsilon_0}$" src="form_141.png"/>, where <img class="formulaInl" alt="$\epsilon_0$" src="form_142.png"/> is the permitivity of free space in <img class="formulaInl" alt="$\frac{mol}{kcal\ \AA}$" src="form_143.png"/>). This apparently varies from force field to force field in Tinker...</li>
<li><code>dielectric</code> : the dielectric constant (or absolute permitivity) for the force field</li>
<li><code>torsionunit</code> : how much to scale torsion energy by<ul>
<li>Typically used if 0.5 of Fourier series is not included in amplitude</li>
</ul>
</li>
<li><code>imptorunit</code> : how much to scale imptorsion energy by<ul>
<li>Typically used if 0.5 of Fourier series is not included in amplitude</li>
</ul>
</li>
</ul>
<h3>Atom Types and Class Types</h3>
<p>This is the specification of the atom and class types the format is:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;atom &lt;atom type&gt; &lt;class type&gt; &lt;symbol&gt; &lt;description&gt; &lt;atomic number&gt; &lt;mass&gt;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;&lt;number of bonds&gt;</div></div><!-- fragment --><ul>
<li><code>atom</code> : this is flag to specify that we are defining atom types and classes</li>
<li><code>atom type</code> : this is an integer specifying which atom type we are defnining</li>
<li><code>class type</code> : this is an integer specifying the class type</li>
<li><code>symbol</code> : A few characters describing the atom type, is usually some mixture of the atomic symbol and a letter to describe the chemical environment like T for terminal</li>
<li><code>description</code> : a string giving a more readable description</li>
<li><code>atomic number</code> : The atomic number of the atom as it appears on the periodic table</li>
<li><code>mass</code> : the isotope averaged mass of the atom in Daltons, i.e. the mass you find on the periodic table</li>
<li><code>number of bonds</code> : the usual number of bonds that an atom of this atom type makes</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>ForceManII only reads the first three fields</dd></dl>
<h3>Parameters</h3>
<dl class="section note"><dt>Note</dt><dd>If you specify a parameter more than once the last value will be used</dd>
<dd>
It appears that Tinker sometimes lists a set of types/classes, but no parameters for them. I'm treating this as missing parameters.</dd></dl>
<h4>Harmonic Bond Stretching Potential</h4>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;bond   &lt;class 1&gt;  &lt;class 2&gt; &lt;k&gt; &lt;r_0&gt;</div></div><!-- fragment --><ul>
<li><code>bond</code> : a flag to specify these parameters are for bonds</li>
<li><code>class 1</code> : the class of one of the two atoms</li>
<li><code>class 2</code> : the class for the other atom</li>
<li><code>k</code> : the force constant in kcal/(mol Angstrom <img class="formulaInl" alt="$^2$" src="form_84.png"/>), the 1/2 of the harmonic potential is included</li>
<li><code>r_0</code> : the equilibrium distance for the bond in Angstroms</li>
</ul>
<p>Tinker appears to follow the convention that class 1 is less than or equal to class 2. Upon parsing, ForceManII enforces this ordering.</p>
<h4>Angle-Bending Harmonic Potential Parameters</h4>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;angle  &lt;class 1&gt; &lt;vertex class&gt; &lt;class 2&gt; &lt;k&gt; &lt;theta_0&gt;</div></div><!-- fragment --><ul>
<li><code>angle</code> : a flag to specify that these are parameters for an angle</li>
<li><code>class 1</code> : one of the non-vertex atoms' class</li>
<li><code>vertex class</code> : the class of the vertex atom</li>
<li><code>class 2</code> : the other non-vertex atom's class</li>
<li><code>force constant</code> : the force constant in kcal/(mol*radians <img class="formulaInl" alt="$^2$" src="form_84.png"/>)</li>
<li><code>theta_0</code> : the equilibrium angle in degrees</li>
</ul>
<p>Tinker appears to follow the convention that class 1 is less than or equal to class 2 (the vertex atom always appears in the middle, regardless of value). Upon parsing, ForceManII will enforce this ordering.</p>
<h4>Urey-Bradley Paramaters (1-3 interactions)</h4>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;ureybrad     &lt;class 1&gt; &lt;vertex class&gt; &lt;class 2&gt; &lt;k&gt; &lt;r0&gt;</div></div><!-- fragment --><ul>
<li><code>ureybrad</code> : a flag to specify that this is a 1-3 interaction</li>
<li><code>class 1</code> : the class of one of the end atoms</li>
<li><code>vertex class</code> : the class of the vertex atom</li>
<li><code>class 2</code> : the class of the other end atom</li>
<li><code>k</code> : the harmonic force constant in kcal/(mol*Angstroms <img class="formulaInl" alt="$^2$" src="form_84.png"/>)</li>
<li><code>r0</code> : the equilibrium distance between the two end atoms in Angstroms</li>
</ul>
<p>Tinker appears to follow the convention that class 1 is less than or equal to class 2. We enforce this ordering while parsing.</p>
<p>#### Torsion Fourier-Series Parameters </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;torsion &lt;end 1&gt; &lt;center 1&gt; &lt;center 2&gt; &lt;end 2&gt; &lt;V&gt; &lt;gamma&gt; &lt;n&gt;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;[&lt;V&gt; &lt;gamma&gt; &lt;n&gt; [&lt;V&gt; &lt;gamma&gt; &lt;n&gt;]]</div></div><!-- fragment --><ul>
<li><code>torsion</code> : a flag specifying these are parameters for a proper torsion</li>
<li><code>end 1</code> : the class type of one of the ends of the torsion angle</li>
<li><code>center 1</code> : the class type of the central atom bonded to the first end atom</li>
<li><code>center 2</code> : the class type of the next central atom</li>
<li><code>end 2</code> : the class type of the other end atom</li>
<li><code>V</code> : the amplitude of the Fourier Series component in kcal/mol</li>
<li><code>gamma</code> : the equlibrium value of the torsion in degrees</li>
<li><code>n</code> : the periodicity of the Fourier Series component</li>
<li>Other values of <code>V</code>, <code>gamma</code>, and <code>n</code> can optionally be repeated up to another two times to specify additional terms in the Fourier Series for this interaction</li>
</ul>
<p>Tinker appears to follow the convention that center 1 is less than or equal to center 2, in the event that they are equal, ordering continues by ensuring end 1 is less than or equal to end 2. ForceManII will enforce this while parsing.</p>
<h4>Improper Torsion Fourier-Series Parameters</h4>
<dl class="section note"><dt>Note</dt><dd>The difference between a Fourier-Series and a harmonic oscillator is the flag (imptors vs. improper resepctively)</dd></dl>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;imptors &lt;class type 1&gt; &lt;class type 2&gt; &lt;central class type&gt; &lt;class type 3&gt; &lt;V&gt;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;&lt;gamma&gt; &lt;n&gt;</div></div><!-- fragment --><p> or in the case of CHARMM ordering force fields:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;imptors &lt;central class type&gt; &lt;class type 1&gt; &lt;class type 2&gt;  &lt;class type 3&gt; &lt;V&gt;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;&lt;gamma&gt; &lt;n&gt;</div></div><!-- fragment --><ul>
<li><code>imptors</code> : a flag specifying these are parameters for an improper torsion</li>
<li><code>atom type 1</code> : the atom type of one of the orbital atoms</li>
<li><code>atom type 2</code> : the atom type of one of the other orbital atoms</li>
<li><code>central atom type</code> : the atom type of the central atom</li>
<li><code>atom type 3</code> : the atom type of the last orbital atom</li>
<li><code>V</code> : the amplitude of the Fourier Series component in kcal/mol</li>
<li><code>gamma</code> : the equlibrium value of the torsion in degrees</li>
<li><code>n</code> : the periodicity of the Fourier Series component</li>
</ul>
<p>Tinker appears to follow the convention that the class types 1, 2, and 3 are listed in ascending order. Upon parsing ForceManII will enforce this and switch the central atom to the second value in the ordered pair as described <a class="el" href="torsion.html">here</a>.</p>
<p>#### Improper Torsion Harmonic-Oscillator Parameters </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;improper &lt;class type 1&gt; &lt;class type 2&gt; &lt;central class type&gt; &lt;class type 3&gt; &lt;k&gt;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;&lt;gamma&gt;</div></div><!-- fragment --><p> or in the case of CHARMM ordering force fields:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;improper &lt;central class type&gt; &lt;class type 1&gt; &lt;class type 2&gt;  &lt;class type 3&gt; &lt;K&gt;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;&lt;gamma&gt;</div></div><!-- fragment --><ul>
<li><code>improper</code> : a flag specifying these are parameters for an improper torsion</li>
<li><code>atom type 1</code> : the atom type of one of the orbital atoms</li>
<li><code>atom type 2</code> : the atom type of one of the other orbital atoms</li>
<li><code>central atom type</code> : the atom type of the central atom</li>
<li><code>atom type 3</code> : the atom type of the last orbital atom</li>
<li><code>K</code> : the force consant in kcal/(mol radians <img class="formulaInl" alt="$^2$" src="form_84.png"/>)</li>
<li><code>gamma</code> : the equlibrium value of the torsion in degrees</li>
</ul>
<p>Tinker appears to follow the convention that the class types 1, 2, and 3 are listed in ascending order. Upon parsing ForceManII will enforce this and switch the central atom to the second value in the ordered pair as described <a class="el" href="torsion.html">here</a>.</p>
<p>Tinker also has another annoying feature for CHARMM. Recall how people can't agree on how to compute improper dihedrals (see <a class="el" href="torsion.html">here</a> for more details). It turns out CHARMM</p>
<h4>Charge-Charge Potential Parameters</h4>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;charge &lt;vdw type&gt; &lt;q&gt;</div></div><!-- fragment --><ul>
<li><code>charge</code> : a flag specifying these parameters are for a charge</li>
<li><code>vdw type</code> : the vdw type of the atom</li>
<li><code>q</code> : the charge in atomic units, i.e. number of electrons</li>
</ul>
<h4>Lennard-Jones 6-12 Potential Parameters</h4>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;vdw           &lt;atom_type&gt;               &lt;radius&gt; &lt;epsilon&gt;</div></div><!-- fragment --><ul>
<li><code>vdw</code> : a flag to specify that these are parameters for van Der Waals interaction</li>
<li><code>atom_type</code> : the atom type this parameter is for</li>
<li><code>radius</code> : the radius (or diameter depending on the metadata provided) in Angstroms</li>
<li><code>epsilon</code> : the well depth in kcal/mol</li>
</ul>
<h2><a class="anchor" id="file_tinker_xyz"></a>
The Tinker .xyz File</h2>
<p>The first line of the Tinker xyz file is the number of atoms followed by an optional comment. This differs from the traditional format which has the comment on the second line. The listing of the atoms then starts on the second line in a Tinker xyz file as opposed to the third line in the usual xyz file.</p>
<p>For each atom line the columns respectively are:</p><ul>
<li>the atom number (the line number minus 1 assuming they are ordered)</li>
<li>the symbol for the atom's type as it appears in the <code>atom</code> section of the force field parameter file to be applied to the system.</li>
<li>the x coordinate in Angstroms</li>
<li>the y coordinate in Angstroms</li>
<li>the z coordinate in Angstroms</li>
<li>the numeric atom type (corresponding to the force field that will be used)</li>
<li>(optionally and if applicable) the first atom this atom is bonded to</li>
<li>(optionally and if applicable) the second atom this atom is bonded to</li>
<li>(optionally and if applicable) the third atom this atom is bonded to</li>
<li>(optionally and if applicable) the fourth atom this atom is bonded to</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>If an atom makes less than four bonds no place holder is used for the missing bonds</dd></dl>
<p>It is unclear to me whether the Tinker xyz format allows for bonding to more than four atoms, but the extension to this case is obvious. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
