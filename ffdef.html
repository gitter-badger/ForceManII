<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>ForceManII: Force Field Definition in ForceManII</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">ForceManII
   &#160;<span id="projectnumber">0.1</span>
   </div>
   <div id="projectbrief">MM for QM People</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Force Field Definition in ForceManII </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>ForceManII breaks from the traditional ways of thinking about many MM related ideas. What is a force field is one of them. This page is meant to explain my logic and also introduce you to the ForceField class.</p>
<h2>Abstract Background</h2>
<p>Overall, in MM we think of our energy, <img class="formulaInl" alt="$E$" src="form_54.png"/>, as being a function of a set of Cartesian coordinates, the vector of which we denote <img class="formulaInl" alt="$\vec{x}$" src="form_57.png"/>. <img class="formulaInl" alt="$E$" src="form_54.png"/> is then thought of as being composed of some small integer number of terms, <img class="formulaInl" alt="$n_{\text{terms}}$" src="form_58.png"/>, such that <img class="formulaInl" alt="$E(\vec{x})=\sum_{=1}^{n_\text{terms}}E_i(\vec{x})$" src="form_59.png"/>, where <img class="formulaInl" alt="$E_i$" src="form_60.png"/> is the <img class="formulaInl" alt="$i$" src="form_25.png"/>-th term. In general, the terms do not directly depend on <img class="formulaInl" alt="$\vec{x}$" src="form_57.png"/>, but rather on the mapping of <img class="formulaInl" alt="$\vec{x}$" src="form_57.png"/> to some other vector <img class="formulaInl" alt="$\vec{q}$" src="form_53.png"/>. If <img class="formulaInl" alt="$\vec{x}$" src="form_57.png"/> is the vector of Cartesian coordinates then <img class="formulaInl" alt="$\vec{q}$" src="form_53.png"/> is a vector of the internal coordinates (bonds, angles, etc.). It is somewhat helpful to partition <img class="formulaInl" alt="$\vec{q}$" src="form_53.png"/> into segments where each segment is all internal coordinates of one type (say bonds). Thus the mapping to the <img class="formulaInl" alt="$i$" src="form_25.png"/>-th type of internal coordinate is <img class="formulaInl" alt="$\vec{q}_i(\vec{x})$" src="form_61.png"/>.</p>
<p>Of course the hallmark of a force field is its set of emperical parameters, which we label <img class="formulaInl" alt="$\vec{t}$" src="form_62.png"/>. In general there will be one set of parameters for each interal coordinate type, the one associated with the <img class="formulaInl" alt="$i$" src="form_25.png"/>-th internal type being <img class="formulaInl" alt="$\vec{t}_i$" src="form_63.png"/>. Although somewhat simple to do in practice, abstractly defining the mapping between the system and the parameters is no small feat, in part due to a lack of a standard in the MM community. In the most general case, one first maps <img class="formulaInl" alt="$\vec{x}$" src="form_57.png"/> to a set of chemical moieties (functional groups, amino acids, DNA bases, etc.). Each of the chemical moieties is then mapped to an integer. We have no need of the intermediate mapping presently and define <img class="formulaInl" alt="$n(\vec{x}$" src="form_64.png"/> to be the mapping of the system to a set of integers, with each integer being affiliated with a particular chemical moiety. The integers are the atom types. This mapping is usually too much to parameterize, so similar chemical moieties are parameterized in groups. This leads to a second map <img class="formulaInl" alt="$N[n(\vec{x})]$" src="form_65.png"/>, which generates what we call our chemcial classes, but in general <img class="formulaInl" alt="$N$" src="form_36.png"/> is to be thought of as the mapping to the final integer. These classes are for atoms, not internal coordinates so we need another mapping that defines associates these classes with internal coordinates; conceptually this is similar to <img class="formulaInl" alt="$\vec{q}$" src="form_53.png"/> so we define the mapping to the <img class="formulaInl" alt="$i$" src="form_25.png"/>-th internal coordinate as <img class="formulaInl" alt="$\vec{q}_i(N[n(\vec{x})])$" src="form_66.png"/>. Now this is mapped to the final set of parameters, which gives rise to the mapping: <img class="formulaInl" alt="$\vec{t}_i[\vec{q}_i(N[n(\vec{x})])]$" src="form_67.png"/>. Unfortunately, this isn't quite complete as sometimes, depending on the internal coordinate type, the parameters in <img class="formulaInl" alt="$\vec{t}_i$" src="form_63.png"/> are then mapped to another set of parameters, <img class="formulaInl" alt="$\vec{t}^\prime_i$" src="form_68.png"/>.</p>
<p>It is thus more appropriate to write our energy expansion as </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ E(\vec{x};\mathbf{T},\vec{c})= \sum_{=1}^{n_\text{terms}}c_iE_i( \mathbf{q}(\vec{x});\mathbf{t}^\prime(\mathbf{t}[\mathbf{q}(N[n(\vec{x})])])). \]" src="form_69.png"/>
</p>
<p> where we have also allowed for a reweighting of the terms so that energy term <img class="formulaInl" alt="$i$" src="form_25.png"/>, has a weight <img class="formulaInl" alt="$c_i$" src="form_70.png"/> and introduced bold face quantities to be the set of that quantity for all internal coordinates. The definition of all of the above quantities and mappings defines a force field. Like I said, I think this is a rather unique perspective on what a force field is, but it is one that falls out of the computer science.</p>
<h2>Parts of a Force Field</h2>
<p>From the discussion above we conclude that the input to a force field is a molecular system and the output is an energy or energy derivative. The most general force field includes definitions of the required mappings, as well as the parameters and weights. This means we need you to define:</p>
<ul>
<li>A set of energy terms<ul>
<li>The form of these terms are usually simple: harmonic oscillator, Fourier Series, etc.</li>
<li>The same form may be used for multiple terms, but with a different set of parameters (<em>e.g</em> harmonic bond-stretching vs. harmonic angle-bending)</li>
</ul>
</li>
<li>A set of weights for each term<ul>
<li>Usually these are unity, unless the term is for a pair of atoms seperated by four or five bonds.</li>
</ul>
</li>
<li>An initial set of parameters for each internal coordinate<ul>
<li>Usually a map from the union of the atom type/classes to some scalars, but may also be to vectors</li>
</ul>
</li>
<li>A means of mapping the initial set of parameters to the final set<ul>
<li>Can be an identity mapping</li>
<li>Usually only used for combining epsilons and sigmas of Lennard Jones potentials so that one need not store all pair-wise combinations of them</li>
<li>Usually is something simiple like arthemetic or geometric mean</li>
<li>Note this requires a mapping of the atomic charges to their product in the case of the Coulomb term. This is because to work correctly in this framework all energy terms take the parameters for the internal coordinate and not the individual atoms.</li>
</ul>
</li>
<li>A list of which terms use atom type and which use atom class</li>
<li>A mapping of atom type to atom class</li>
</ul>
<p>ForceManII will (can) take care of:</p>
<ul>
<li>Computing the internal coordinates (given the system and connectivity)</li>
<li>Mapping the internal coordinates to the final integer (given the ff, inteneral coordinates, and types of each atom)</li>
<li>Mapping the final integers to the final parameters (given the ff)</li>
<li>Computing the derivative (given the internal coordinates and final parameters)</li>
</ul>
<p>In short, other than defining a force field (we provide some of the more popular ones for you) you need to give us the Cartesian coordinates, connectivity, and atom types of your system to use the library. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.3.1
</small></address>
</body>
</html>
