<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>ForceManII: Fourier Series</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ForceManII
   &#160;<span id="projectnumber">0.1</span>
   </div>
   <div id="projectbrief">MM for QM People</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Fourier Series </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Torsion and improper torsion angles are typically modled as Fourier series. In general a Fourier series has the form: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ E(\theta)=\sum_{n=0}^\infty \frac{1}{2}a_n \cos\left(\frac{2\pi n\theta}{P}-\gamma\right), \]" src="form_64.png"/>
</p>
<p> (or a form in which cosine is replaced with sine and the values of the parameters change to reflect that cosine is sine shifted by 90 degrees). Here <img class="formulaInl" alt="$P$" src="form_65.png"/> is the periodicity of the function, <img class="formulaInl" alt="$a_n$" src="form_66.png"/> is the height of a particular wave's contribution, and <img class="formulaInl" alt="$\gamma$" src="form_67.png"/> is a phase shift. In modeling torsions, the angle is periodic every 360 degrees ( <img class="formulaInl" alt="$P=2\pi$" src="form_68.png"/>) and we want the energy to be 0 at the minimum (i.e. not -1.0), hence we usually add 1 to the cosine term, the result is: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ E(\theta)=\sum_{n=0}^\infty \frac{1}{2}a_n\left[1+\cos\left(n\theta-\gamma\right)\right], \]" src="form_69.png"/>
</p>
<p> Since most atoms involved in force fields make at most four bonds, the entire potential should be modelable using only the terms up to <img class="formulaInl" alt="$n=3$" src="form_70.png"/>. It is customary to use <img class="formulaInl" alt="$\gamma$" src="form_67.png"/> so that a minimum occurs at 180 degrees, which means for even <img class="formulaInl" alt="$n$" src="form_71.png"/>, <img class="formulaInl" alt="$\gamma=2\pi$" src="form_72.png"/> and for odd <img class="formulaInl" alt="$n$" src="form_71.png"/> <img class="formulaInl" alt="$\gamma=0$" src="form_73.png"/>.</p>
<p>Aside from that the first and second derivatives are easily seen to be: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \frac{\partial E(\theta)}{\partial \theta}=-\frac{1}{2}\sum_{n=0}^\infty n a_n\sin(n\theta-\gamma) \]" src="form_74.png"/>
</p>
<p> and: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \frac{\partial^2 E(\theta)}{\partial^2 \theta}=-\frac{1}{2}\sum_{n=0}^\infty n^2 a_n\cos(n\theta-\gamma). \]" src="form_75.png"/>
</p>
<p>This pattern continues and we see that the <img class="formulaInl" alt="$d$" src="form_91.png"/>-th order derivative is: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \frac{\partial E(\theta)}{\partial \theta}=(-1)^{(d+1)/2}\frac{1}{2}\sum_{n=0}^\infty n^d a_n\sin(n\theta-\gamma) \]" src="form_92.png"/>
</p>
<p> if <img class="formulaInl" alt="$d$" src="form_91.png"/> is odd, and: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \frac{\partial^2 E(\theta)}{\partial^2 \theta}=(-1)^{d/2}\frac{1}{2}\sum_{n=0}^\infty n^d a_n\cos(n\theta-\gamma) \]" src="form_93.png"/>
</p>
<p> if <img class="formulaInl" alt="$d$" src="form_91.png"/> is even.</p>
<h2>Conventions, i.e. What to Do with the Half?</h2>
<p>The Fourier series will ultimately be used for both the torsion and improper torsion angles. Unfortunately, the customary half is not present in the form of the improper torsion. Furthermore, Tinker style parameter files typically bake the half into the torsion parameter already anyways. Unlike the harmonic oscillator where there is actually an advantage to having the half around (it simplifies the derivatives), the half of the Fourier series does nothing for us. For these reasons I have decied to follow Tinker's lead and bake the half into the torsion amplitude parameter.</p>
<h2>Implementation Details</h2>
<p>Keeping with the idea of making the interface as simple as possible, the FourierSeries class only takes the amplitudes, angles, and periodicities. This is because the derivative only depends on these quantities. The angle is passed in a somewhat special way, namely as <img class="formulaInl" alt="$n\theta-\gamma$" src="form_85.png"/>, this is because this is always the argument to the trig function, regardless of the derivative order. Unlike the harmonic oscillator where we can forget about the details of the shift, for the Fourier series we have to know the value of <img class="formulaInl" alt="$n$" src="form_71.png"/> for the derivatives. Finally, we ask that for torsions with multiple terms, i.e. for torsions that have multiple, and <img class="formulaInl" alt="$n,\gamma,a_n$" src="form_94.png"/> terms, act as if each set of parameters is a new torsion (call the function once for each set of parameters). </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
