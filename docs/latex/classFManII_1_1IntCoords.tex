\hypertarget{classFManII_1_1IntCoords}{}\section{F\+Man\+II\+:\+:Int\+Coords Class Reference}
\label{classFManII_1_1IntCoords}\index{F\+Man\+I\+I\+::\+Int\+Coords@{F\+Man\+I\+I\+::\+Int\+Coords}}


A base class designed to provide basic functionality to things like bonds, angles, etc.  




{\ttfamily \#include $<$Internal\+Coordinates.\+hpp$>$}



Inheritance diagram for F\+Man\+II\+:\+:Int\+Coords\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classFManII_1_1IntCoords__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for F\+Man\+II\+:\+:Int\+Coords\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classFManII_1_1IntCoords__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
{\footnotesize template$<$typename... args$>$ }\\void \hyperlink{classFManII_1_1IntCoords_aaa13717daa2c47a00c56e8dcb18896b6}{add\+\_\+coord} (const \hyperlink{classFManII_1_1IntCoords_a59ab25571f774fca97644a2ce5ade359}{Atoms\+\_\+t} \&coord, \hyperlink{namespaceFManII_ab331802fde4c5f2564443f1704c25363}{Param\+\_\+t} param, double pvalue, args...\+other\+\_\+params)
\begin{DoxyCompactList}\small\item\em The call to add a coordinate to this Int\+Coord. \end{DoxyCompactList}\item 
const \hyperlink{classFManII_1_1IntCoords_af42df2795dec16350f908cfd5ac2ef06}{V\+Double} \& \hyperlink{classFManII_1_1IntCoords_a8b36508bebeb262d2c41bed1301ad9f9}{values} () const \hypertarget{classFManII_1_1IntCoords_a8b36508bebeb262d2c41bed1301ad9f9}{}\label{classFManII_1_1IntCoords_a8b36508bebeb262d2c41bed1301ad9f9}

\begin{DoxyCompactList}\small\item\em Returns the array of coordinates. \end{DoxyCompactList}\item 
const \hyperlink{classFManII_1_1IntCoords_af42df2795dec16350f908cfd5ac2ef06}{V\+Double} \& \hyperlink{classFManII_1_1IntCoords_ac107ad541179d838052f37538883671a}{params} (\hyperlink{namespaceFManII_ab331802fde4c5f2564443f1704c25363}{Param\+\_\+t} pt) const \hypertarget{classFManII_1_1IntCoords_ac107ad541179d838052f37538883671a}{}\label{classFManII_1_1IntCoords_ac107ad541179d838052f37538883671a}

\begin{DoxyCompactList}\small\item\em Returns the array of a particular parameter. \end{DoxyCompactList}\item 
virtual \hyperlink{classFManII_1_1IntCoords_ad31ec2a0d63bb2fc33677057546d2763}{$\sim$\+Int\+Coords} ()\hypertarget{classFManII_1_1IntCoords_ad31ec2a0d63bb2fc33677057546d2763}{}\label{classFManII_1_1IntCoords_ad31ec2a0d63bb2fc33677057546d2763}

\begin{DoxyCompactList}\small\item\em Virtual Dtor so compiler doesn\textquotesingle{}t complain, but does nothing. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Protected Types}
\begin{DoxyCompactItemize}
\item 
using \hyperlink{classFManII_1_1IntCoords_a59ab25571f774fca97644a2ce5ade359}{Atoms\+\_\+t} = std\+::vector$<$ size\+\_\+t $>$\hypertarget{classFManII_1_1IntCoords_a59ab25571f774fca97644a2ce5ade359}{}\label{classFManII_1_1IntCoords_a59ab25571f774fca97644a2ce5ade359}

\begin{DoxyCompactList}\small\item\em Typedef for the set of atoms in an Int\+Coord. \end{DoxyCompactList}\item 
using \hyperlink{classFManII_1_1IntCoords_af42df2795dec16350f908cfd5ac2ef06}{V\+Double} = std\+::vector$<$ double $>$\hypertarget{classFManII_1_1IntCoords_af42df2795dec16350f908cfd5ac2ef06}{}\label{classFManII_1_1IntCoords_af42df2795dec16350f908cfd5ac2ef06}

\begin{DoxyCompactList}\small\item\em Typedef for a vector of doubles. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
virtual \hyperlink{classFManII_1_1IntCoords_af42df2795dec16350f908cfd5ac2ef06}{V\+Double} \hyperlink{classFManII_1_1IntCoords_ae8d77a3410edbc99357a2289feeec510}{compute\+\_\+value} (size\+\_\+t deriv\+\_\+i, \hyperlink{classFManII_1_1IntCoords_a59ab25571f774fca97644a2ce5ade359}{Atoms\+\_\+t} coord\+\_\+i) const =0
\begin{DoxyCompactList}\small\item\em Overridden by the derived class so that it computes the i-\/th derivative of the coordinate which involves the specified atoms. \end{DoxyCompactList}\item 
void \hyperlink{classFManII_1_1IntCoords_a21ae6c2eb4a0dbea71a402f399061d5b}{add\+\_\+coord} (const \hyperlink{classFManII_1_1IntCoords_a59ab25571f774fca97644a2ce5ade359}{Atoms\+\_\+t} \&coord)\hypertarget{classFManII_1_1IntCoords_a21ae6c2eb4a0dbea71a402f399061d5b}{}\label{classFManII_1_1IntCoords_a21ae6c2eb4a0dbea71a402f399061d5b}

\begin{DoxyCompactList}\small\item\em Recursion end point. \end{DoxyCompactList}\item 
\hyperlink{classFManII_1_1IntCoords_aff5b80e7f579dd8aeac5200942b4db87}{Int\+Coords} (size\+\_\+t N\+Atoms, std\+::shared\+\_\+ptr$<$ const \hyperlink{classFManII_1_1IntCoords_af42df2795dec16350f908cfd5ac2ef06}{V\+Double} $>$ Carts)\hypertarget{classFManII_1_1IntCoords_aff5b80e7f579dd8aeac5200942b4db87}{}\label{classFManII_1_1IntCoords_aff5b80e7f579dd8aeac5200942b4db87}

\begin{DoxyCompactList}\small\item\em {\ttfamily Carts} is coordinates of the molecule in a.\+u. in a N\+Atoms X 3 array \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Protected Attributes}
\begin{DoxyCompactItemize}
\item 
size\+\_\+t \hyperlink{classFManII_1_1IntCoords_a3fb097438609927dda0f1a049ff61a72}{natoms\+\_\+}\hypertarget{classFManII_1_1IntCoords_a3fb097438609927dda0f1a049ff61a72}{}\label{classFManII_1_1IntCoords_a3fb097438609927dda0f1a049ff61a72}

\begin{DoxyCompactList}\small\item\em The number of atoms this coordinate depends on. \end{DoxyCompactList}\item 
std\+::shared\+\_\+ptr$<$ const \hyperlink{classFManII_1_1IntCoords_af42df2795dec16350f908cfd5ac2ef06}{V\+Double} $>$ \hyperlink{classFManII_1_1IntCoords_a54cd82d40213e7c85ea338b79438b22a}{carts\+\_\+}\hypertarget{classFManII_1_1IntCoords_a54cd82d40213e7c85ea338b79438b22a}{}\label{classFManII_1_1IntCoords_a54cd82d40213e7c85ea338b79438b22a}

\begin{DoxyCompactList}\small\item\em The cartesian coordinates of the system in a.\+u. \end{DoxyCompactList}\item 
\hyperlink{classFManII_1_1IntCoords_af42df2795dec16350f908cfd5ac2ef06}{V\+Double} \hyperlink{classFManII_1_1IntCoords_a1dfc726f1b6060c0f4e26eafb51953f9}{value\+\_\+}\hypertarget{classFManII_1_1IntCoords_a1dfc726f1b6060c0f4e26eafb51953f9}{}\label{classFManII_1_1IntCoords_a1dfc726f1b6060c0f4e26eafb51953f9}

\begin{DoxyCompactList}\small\item\em The actual length of the bond, or angle of the angle, etc. \end{DoxyCompactList}\item 
std\+::vector$<$ \hyperlink{classFManII_1_1IntCoords_a59ab25571f774fca97644a2ce5ade359}{Atoms\+\_\+t} $>$ \hyperlink{classFManII_1_1IntCoords_a4f7c142879fb222c66ae6968160d36c0}{atoms\+\_\+}\hypertarget{classFManII_1_1IntCoords_a4f7c142879fb222c66ae6968160d36c0}{}\label{classFManII_1_1IntCoords_a4f7c142879fb222c66ae6968160d36c0}

\begin{DoxyCompactList}\small\item\em The atom numbers associated with each value. \end{DoxyCompactList}\item 
std\+::map$<$ \hyperlink{namespaceFManII_ab331802fde4c5f2564443f1704c25363}{Param\+\_\+t}, \hyperlink{classFManII_1_1IntCoords_af42df2795dec16350f908cfd5ac2ef06}{V\+Double} $>$ \hyperlink{classFManII_1_1IntCoords_ab1a5fd9c10badbeb02ac40516a7183cc}{params\+\_\+}\hypertarget{classFManII_1_1IntCoords_ab1a5fd9c10badbeb02ac40516a7183cc}{}\label{classFManII_1_1IntCoords_ab1a5fd9c10badbeb02ac40516a7183cc}

\begin{DoxyCompactList}\small\item\em The parameters associated with this set of internal coordinates. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Energetic terms in a force field rely on determining how far an internal coordinate, or Int\+Coord for short, is from an equilibrium value. These \hyperlink{classFManII_1_1IntCoords}{Int\+Coords} are things like bonds, angles, torsions, etc. and the force field maps the energetic cost of displacing these \hyperlink{classFManII_1_1IntCoords}{Int\+Coords} to simple functional forms. Hence it is key that we have a class to describe these internal coordinates.

Each instance of this class is designed to work with a single system. If you need to have \hyperlink{classFManII_1_1IntCoords}{Int\+Coords} for multiple systems make multiple instances. Basic workflow with this class is give it a natoms by 3 array of Cartesian coordinates at creation. At creation the order of the atoms is irrelevant, but after creation all further input with this class will refer to that ordering. Next an algorithm above this class locates the internal coordinate of choice (i.\+e. using the connectivity you find say a bond) you then add that bond to this class like\+: 
\begin{DoxyCode}
\hyperlink{classFManII_1_1IntCoords_aff5b80e7f579dd8aeac5200942b4db87}{IntCoords} Bonds(System);
Bonds.add\_coord(\{1,2\},\hyperlink{namespaceFManII_ab331802fde4c5f2564443f1704c25363acce4c4e3a7008d8a210e0950f0ae6646}{Param\_t::K},value\_of\_K);
\end{DoxyCode}
 and similarly for other coordinates. 

\subsection{Member Function Documentation}
\index{F\+Man\+I\+I\+::\+Int\+Coords@{F\+Man\+I\+I\+::\+Int\+Coords}!add\+\_\+coord@{add\+\_\+coord}}
\index{add\+\_\+coord@{add\+\_\+coord}!F\+Man\+I\+I\+::\+Int\+Coords@{F\+Man\+I\+I\+::\+Int\+Coords}}
\subsubsection[{\texorpdfstring{add\+\_\+coord(const Atoms\+\_\+t \&coord, Param\+\_\+t param, double pvalue, args...\+other\+\_\+params)}{add_coord(const Atoms_t &coord, Param_t param, double pvalue, args...other_params)}}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename... args$>$ void F\+Man\+I\+I\+::\+Int\+Coords\+::add\+\_\+coord (
\begin{DoxyParamCaption}
\item[{const {\bf Atoms\+\_\+t} \&}]{coord, }
\item[{{\bf Param\+\_\+t}}]{param, }
\item[{double}]{pvalue, }
\item[{args...}]{other\+\_\+params}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{classFManII_1_1IntCoords_aaa13717daa2c47a00c56e8dcb18896b6}{}\label{classFManII_1_1IntCoords_aaa13717daa2c47a00c56e8dcb18896b6}
Don\textquotesingle{}t be offput by the signature using this function is pretty easy. The first argument is the atoms in this coordinate. The remaining 2N arguments are the N parameters associated with this coordinate. They must be in the order parameter type, value of that parameter, next parameter type, value of the next parameter, etc. You will get a compile time error if you do not supply pairs for each parameter or if you mix up the order.

Point is usage looks like this\+: 
\begin{DoxyCode}
\textcolor{comment}{//Assume these are already made instances of IntCoords}
\hyperlink{classFManII_1_1IntCoords_aff5b80e7f579dd8aeac5200942b4db87}{IntCoords} MyBonds,MyAngles;

\textcolor{comment}{//Adds a bond between atoms 1 and 2 with a force constant of 3.4}
MyBonds.add\_coord(\{1,2\},\hyperlink{namespaceFManII_ab331802fde4c5f2564443f1704c25363acce4c4e3a7008d8a210e0950f0ae6646}{Param\_t::K},3.4);

\textcolor{comment}{//Adds an angle among atoms 1, 2, and 3 with force constant 3.3}
MyAngles.add\_coord(\{1,2,3\},\hyperlink{namespaceFManII_ab331802fde4c5f2564443f1704c25363acce4c4e3a7008d8a210e0950f0ae6646}{Param\_t::K},3.3);
\end{DoxyCode}



\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em coord} & An array of the atoms in the coordinate. Numbers must correspond to the order given at instance creation \\
\hline
\mbox{\tt in}  & {\em param} & The type of the parameter, e.\+g. force constant \\
\hline
\mbox{\tt in}  & {\em pvalue} & The value of the parameter in a.\+u. \\
\hline
\mbox{\tt in}  & {\em other\+\_\+params} & Remaining parameter type, parameter value pairs \\
\hline
\end{DoxyParams}
\index{F\+Man\+I\+I\+::\+Int\+Coords@{F\+Man\+I\+I\+::\+Int\+Coords}!compute\+\_\+value@{compute\+\_\+value}}
\index{compute\+\_\+value@{compute\+\_\+value}!F\+Man\+I\+I\+::\+Int\+Coords@{F\+Man\+I\+I\+::\+Int\+Coords}}
\subsubsection[{\texorpdfstring{compute\+\_\+value(size\+\_\+t deriv\+\_\+i, Atoms\+\_\+t coord\+\_\+i) const =0}{compute_value(size_t deriv_i, Atoms_t coord_i) const =0}}]{\setlength{\rightskip}{0pt plus 5cm}virtual {\bf V\+Double} F\+Man\+I\+I\+::\+Int\+Coords\+::compute\+\_\+value (
\begin{DoxyParamCaption}
\item[{size\+\_\+t}]{deriv\+\_\+i, }
\item[{{\bf Atoms\+\_\+t}}]{coord\+\_\+i}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [pure virtual]}}\hypertarget{classFManII_1_1IntCoords_ae8d77a3410edbc99357a2289feeec510}{}\label{classFManII_1_1IntCoords_ae8d77a3410edbc99357a2289feeec510}
We provide you the derivative order and the coordinate number. At the moment I am assuming that while computing the value some of the parameters can be baked into the value to simplify things later. Specifically I am assuming that the 0-\/th order derivative can just return the difference between the actual value and the equilibrium distance for bonds, angles, and Urey-\/\+Bradley terms.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em deriv\+\_\+i} & What order-\/th derivative should you return? \\
\hline
\mbox{\tt in}  & {\em coord\+\_\+i} & Which coordinate are you taking the derivative of? \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A $(3N)^{i}$ long array of the derivatives in the order\+: x of the first atom in the coord, y of the first atom in the coord, z of the first atom in the coord, x of the second atom in the coord,... along each of the $i$ dimensions of the derivative. 
\end{DoxyReturn}


Implemented in \hyperlink{classFManII_1_1Angle_a48105b9c14048db6ccea1a410e8943f1}{F\+Man\+I\+I\+::\+Angle}, \hyperlink{classFManII_1_1Torsion_a5b1871f59ce0112bd17ee0add9bf993e}{F\+Man\+I\+I\+::\+Torsion}, and \hyperlink{classFManII_1_1Distance_a16c3e07ee527b33379311e9099ec6497}{F\+Man\+I\+I\+::\+Distance}.



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
Internal\+Coordinates.\+hpp\end{DoxyCompactItemize}
