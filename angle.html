<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>ForceManII: Angle Class</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ForceManII
   &#160;<span id="projectnumber">0.1</span>
   </div>
   <div id="projectbrief">MM for QM People</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Angle Class </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The angle class is responsible for normal angle bending terms (i.e. those among three bonded atoms). Assuming the vectors <img class="formulaInl" alt="$\vec{r_{12}}$" src="form_11.png"/> and <img class="formulaInl" alt="$\vec{r_{32}}$" src="form_12.png"/> are vectors parallel to the bond between atoms 1 and 2 and the bond between atoms 2 and 3 respectively the cosine of the angle between these vectors, <img class="formulaInl" alt="$\cos\theta$" src="form_13.png"/> is given by:</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \cos\theta=\frac{\vec{r_{12}}\cdot\vec{r_{32}}} {r_{12} r_{32}}, \]" src="form_14.png"/>
</p>
<p> where <img class="formulaInl" alt="$r$" src="form_15.png"/> denotes the magnitude of <img class="formulaInl" alt="$\vec{r}$" src="form_16.png"/>. We can also express this in terms of the <img class="formulaInl" alt="$\sin\theta$" src="form_17.png"/>: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \sin\theta=\frac{\left(\vec{r_{12}}\times\vec{r_{32}}\right)\cdot\vec{n}} {r_{12} r_{32} n}, \]" src="form_18.png"/>
</p>
<p> where <img class="formulaInl" alt="$\frac{\vec{n}}{n}$" src="form_19.png"/> is a unit vector perpendicular to both <img class="formulaInl" alt="$\vec{r_{12}}$" src="form_11.png"/> and <img class="formulaInl" alt="$\vec{r_{32}}$" src="form_12.png"/>. Consequentially, we can also use the tangent of the angle: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \tan\theta=\frac{\left(\vec{r_{12}}\times\vec{r_{32}}\right)\cdot\vec{n}} {\vec{r_{12}}\cdot\vec{r_{32}}n}. \]" src="form_20.png"/>
</p>
<p>The use of the tangent of the angle is preferred numerically as in most coding languages, there exists a function (usually called <code>atan2</code>) that preserves the sign of the resulting angle and does not suffer from numerical issues at any angle value (90 degrees, which is not in arctangent's range is handled correctly, as is the nefarious angle of 180 degrees which is outside of arccosine's range). </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
