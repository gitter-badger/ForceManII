<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>ForceManII: Distance Class</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ForceManII
   &#160;<span id="projectnumber">0.1</span>
   </div>
   <div id="projectbrief">MM for QM People</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Distance Class </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The Distance class is responsible for storing internal coordinates that only depend on the distance between two points in space. This includes:</p><ul>
<li>Bond terms</li>
<li>Urey-Bradley terms (angle-bond cross terms)</li>
<li>Charge-charge electrostatic terms</li>
<li>Dispersion terms</li>
<li>Exchange terms</li>
</ul>
<h2>Mathematical Description</h2>
<p>Given a pair of atoms, the distance <img class="formulaInl" alt="$r_{12}$" src="form_21.png"/> between them is: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ r_{12}=|\mathbf{r_1}-\mathbf{r_2}|= \sqrt{\sum_{i=1}^3\left(q_{1i}-q_{2i}\right)^2}, \]" src="form_22.png"/>
</p>
<p> where <img class="formulaInl" alt="$\mathbf{r_i}$" src="form_23.png"/> is the position of atom <img class="formulaInl" alt="$i$" src="form_10.png"/> and <img class="formulaInl" alt="$q_{ij}$" src="form_24.png"/> is the <img class="formulaInl" alt="$j$" src="form_25.png"/>-th Cartesian coordinate of that atom. In vector format this is: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ r_{12}=\sqrt{\vec{r}_{1}^2-2\vec{r}_1\cdot\vec{r}_2+\vec{r}_2^2} \]" src="form_155.png"/>
</p>
<p>The derivative with respect to <img class="formulaInl" alt="$r_1$" src="form_156.png"/> is: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \frac{\partial r_{12}}{\partial \vec{r}_1}= \frac{1}{2r_{12}}2\vec{r}_1-2\vec{r}_2=\frac{\vec{r}_{12}}{r_{12}} \]" src="form_157.png"/>
</p>
<p> and the derivative with respect to <img class="formulaInl" alt="$r_2$" src="form_158.png"/> is the negative of this. Therefore the gradient is: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \bigtriangledown r_{12}=\frac{1}{r_{12}} \begin{bmatrix}\vec{r}_{12} &amp; -\vec{r}_{12}\end{bmatrix} \]" src="form_167.png"/>
</p>
<p>The gradient of the gradient is: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \bigtriangledown^2 r_{12}=\bigtriangledown (\bigtriangledown r_{12})^T= \bigtriangledown\frac{1}{r_{12}} \begin{bmatrix}\vec{r}_{12}\\-\vec{r}_{12}\end{bmatrix}= \frac{-\left(\bigtriangledown r_{12}\right)^T} {r_{12}}\cdot\left(\bigtriangledown r_{12}\right)+ \frac{1}{r_{12}} \bigtriangledown\begin{bmatrix}\vec{r}_{12}\\-\vec{r}_{12}\end{bmatrix}= \frac{1}{r_{12}}\left(\begin{bmatrix}\mathbf{1}&amp;-\mathbf{1}\\ -\mathbf{1}&amp;\mathbf{1}\end{bmatrix}- \left(\bigtriangledown r_{12}\right)^T\cdot\bigtriangledown r_{12}\right) \]" src="form_174.png"/>
</p>
<p>where a superscript <img class="formulaInl" alt="$T$" src="form_169.png"/> denotes a transpose and <img class="formulaInl" alt="$\mathbf{1}$" src="form_170.png"/> is the 3 by 3 identity matrix.</p>
<dl class="section note"><dt>Note</dt><dd>In the case of the angle-bond cross term the internal coordinate that is usually used is the distance between the ends of the angle. This does not depend on the vertex atom, although the parameters do. </dd></dl>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
