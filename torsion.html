<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>ForceManII: Torsion Angle Class</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ForceManII
   &#160;<span id="projectnumber">0.1</span>
   </div>
   <div id="projectbrief">MM for QM People</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Torsion Angle Class </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><dl class="section warning"><dt>Warning</dt><dd>Energies computed by ForcemanII for the improper torsional energetic components may differ from those of other programs. This is because the improper torsion angle is ill-defined and its value usually depends on the order the atoms are input. We aim for a value that is independent of such conventions and instead use the average of all possible ways of computing the angle. See the improper torsion angle section below for more details.</dd></dl>
<h1>Torsion</h1>
<p>Assume that atom 1 is bonded to atom 2; atom 2 is bonded to atom3, and atom 3 is bonded to atom 4. If we look down the 2-3 bond the 1-2 and 2-3 bonds will make an angle. This angle is the torsion angle. Mathematically this can be viewed as the angle between plane comprised of atoms 1,2, and 3 and the plane comprised of the atoms 2,3,4. Let <img class="formulaInl" alt="$\vec{r_{21}}$" src="form_85.png"/> be a vector parallel to the 1-2 bond pointing from atom 2 to atom 1, <img class="formulaInl" alt="$\vec{r_{23}}$" src="form_86.png"/> be a vector parallel to the 2-3 bond pointing from atom 2 to atom 3, and <img class="formulaInl" alt="$\vec{r_{34}}$" src="form_87.png"/> be a vector parallel to the 3-4 bond pointing from atom 3 to atom 4. <img class="formulaInl" alt="$\vec{n_1}=\vec{r_{21}}\times\vec{r_{23}}$" src="form_88.png"/> is a vector normal to the plane containing atoms 1, 2, and 3 and <img class="formulaInl" alt="$\vec{n_2}=\vec{r_{34}}\times\vec{r_{23}}$" src="form_89.png"/> is a vector normal to the plane containing atoms 2, 3, and 4. The dihedral angle, <img class="formulaInl" alt="$\phi$" src="form_90.png"/> is then given by: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \cos\theta=\frac{\vec{n_1}\cdot\vec{n_2}}{n_1 n_2}. \]" src="form_91.png"/>
</p>
<p> Alternatively: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \vec{n_1}\times\vec{n_2}=\frac{n_1 n_2\sin\theta \vec{n_3}}{n_3} \]" src="form_92.png"/>
</p>
<p> where <img class="formulaInl" alt="$\vec{n_3}$" src="form_93.png"/> is a unit vector perpindicular to <img class="formulaInl" alt="$\vec{n_1}$" src="form_94.png"/> and <img class="formulaInl" alt="$\vec{n_2}$" src="form_95.png"/> and with direction consistent with the right-hand rule. Since, both of our cross products involved <img class="formulaInl" alt="$\vec{r_{23}}$" src="form_86.png"/>, we know that <img class="formulaInl" alt="$\vec{n_3}=\frac{\vec{r_{23}}}{r_{23}}$" src="form_96.png"/>. Given that <img class="formulaInl" alt="$\vec{n_3}$" src="form_93.png"/> is a unit vector we may multiply both sides of the previous equation from the right by it to get: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \sin\theta=\frac{\left(\vec{n_1}\times\vec{n_2}\right)\cdot\vec{r_{23}}} {n_1 n_2 r_{23}} \]" src="form_97.png"/>
</p>
<p> Using the fact that <img class="formulaInl" alt="$\tan\theta=\frac{\sin\theta}{\cos\theta}$" src="form_98.png"/> we also have </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \tan\theta=\frac{\left(\vec{n_1}\times\vec{n_2}\right)\cdot\vec{r_{23}}} {r_{23}} \]" src="form_99.png"/>
</p>
<p>As far as symmetries of the torsion angle are concerned, we have one degree of freedom, we can read the sequence forward or backward. Presently, we choose to read the sequence in which ever manner makes atoms 2 and atoms 3 show up in number order (order in input). Parameters for torsions are expected to be given in an analogous manner (atom type 2 should be less then atom type 3).</p>
<h2>Improper Torsion</h2>
<p>Related to the torsion angle, the improper torsion angle measures the planarity around an sp <img class="formulaInl" alt="$^2$" src="form_84.png"/> hybridized atom. Instead of being a non-branching path i.e. 1 is connected to 2, which is connected to 3, which is connected to 4, the atoms in an improper torsion are all bonded to atom 2. It should be noted that there are other conventions for which atom the central atom is (usually that it is atom 3), but we choose it to be atom 2 as this is naturally where it falls when looping over connectivity.</p>
<p>It is also worth noting a few properties of the improper dihedral angle. Assume for a quadruple of atoms $ a_1,a_2,a_3,a_4$, we always compute our dihedral angle as the angle between the planes formed from the first three atoms, <img class="formulaInl" alt="$a_1, a_2, a_3$" src="form_100.png"/>, and the last three atoms, <img class="formulaInl" alt="$a_2, a_3, a_4$" src="form_101.png"/>. To make this more concrete consider the following example. Our atoms are located at: ~~~ a1 -43.602241118157544, -24.33802667670957, 1.848596102849415 a2 -41.92308162693384, -25.865577231287773, 0.23207724870909 a3 -42.76485062010395, -26.397217623225124, -1.864641766222014 a4 -39.789193591525105, -26.335512400506307, 1.1409900959943542 ~~~</p>
<p>By considering all six permutations of the orbital atoms we generate the following improper torsional angles:</p>
<p>| Permuation | Angle Value (radians) | |---------&mdash;|--------------------&mdash;| | 1,2,3,4 | -3.0739165910027615 | | 3,2,1,4 | 3.0833170468335953 | | 3,2,4,1 | 3.0739165910027615 | | 1,2,4,3 | -3.0833170468335958 | | 4,2,1,3 | 3.073975669189943 | | 4,2,3,1 | -3.073975669189943 |</p>
<p>As you can see (up to a sign) there are three unique angles that can be generated by permuting the definitions of what atom is 1, 3, and 4. By only considering cyclic permutations one can always ensure an angle with the same sign. To make matters worse, after a long search, from what I can tell, the best attempt at ensuring one always uses the same improper torsion is given on <a href="http://chempedia.info/info/165388/">this website</a>. Basically they suggest that the order of the orbtial atoms is that of their input to the program and the central atom is given third for AMBER and first for CHARMM (again, our code requests that the central atom is given second).</p>
<p>Using the same atms, let's see what happens when the central atom is now listed first, like in CHARMM.</p>
<p>| Permuation | Angle Value (radians) | |---------&mdash;|--------------------&mdash;| | 2,1,3,4 | 0.03356224876458078 | | 2,3,1,4 | -0.03356224876458085 | | 2,3,4,1 | 0.04481843274914807 | | 2,1,4,3 | -0.03315167722736386 | | 2,4,1,3 | 0.03315167722736379 | | 2,4,3,1 | -0.044818432749148006 |</p>
<p>Again we end up with three unique angles (up to a sign), with the same sign being given by permutations that are cyclically related. Unfortunately, there is not an easy relation between the angles in CHARMM format and the angles in all other formats ( <img class="formulaInl" alt="$\pi\pm$" src="form_144.png"/> CHARMM angle does not generate the original angles as one naively would have thought). As this ordering seems unique to CHARMM we reorder all CHARMM improper torsions and change their equilibrium distances from 0 radians to <img class="formulaInl" alt="$\pi$" src="form_145.png"/> radians.</p>
<p>In my opinion the value of the angle should not depend on the order of the atoms in the input, as this is an arbitrary ordering. By taking the improper angles in ubiquitin as a test set I have aimed to establish what effect permuations have on the magnitude of the angle. To do this I have computed the standard deviation of the magnitude of the improper torsion resulting from the six permutations above, for each improper torsion angle. I then averaged the resulting standard deviations; the result is that on average permutations can change the magnitude of the angle by about <img class="formulaInl" alt="$\pm 0.25$" src="form_133.png"/> degrees. This suggests that the angles are similar enough that using the average of the six angles should suffice as a value that does not depend on the order of the input atoms. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
